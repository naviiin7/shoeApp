<div class="bg-gray-50 py-16">
  <div class="max-w-7xl mx-auto px-6 lg:px-8">

    <!-- TITLE -->
    <h2 class="text-3xl font-bold text-center mb-10">All Products</h2>

    <!-- FILTER BAR -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-10">

      <!-- Search -->
      <input
        [(ngModel)]="search"
        (input)="onSearch(search)"
        type="text"
        placeholder="Search..."
        class="border border-gray-300 rounded-lg px-4 py-2 w-full focus:ring-2 focus:ring-sky-400"
      />

      <!-- Category -->
      <select
        [(ngModel)]="category"
        (change)="onFilterCategory(category)"
        class="border border-gray-300 rounded-lg px-4 py-2 w-full"
      >
        <option value="all">All Categories</option>
        <option *ngFor="let c of categories" [value]="c">{{ c }}</option>
      </select>

      <!-- Sort -->
      <select
        [(ngModel)]="sort"
        (change)="onSort(sort)"
        class="border border-gray-300 rounded-lg px-4 py-2 w-full"
      >
        <option value="">Sort</option>
        <option value="price-asc">Price: Low → High</option>
        <option value="price-desc">Price: High → Low</option>
        <option value="name-asc">Name A → Z</option>
      </select>

      <!-- Page Size -->
      <select
        [(ngModel)]="pageSize"
        (change)="changePageSize(pageSize)"
        class="border border-gray-300 rounded-lg px-4 py-2 w-full"
      >
        <option *ngFor="let s of [8, 12, 16, 20, 24]" [value]="s">{{ s }} per page</option>
      </select>

    </div>

    <!-- LOADING -->
    <div *ngIf="loading" class="text-center py-10 text-gray-500">
      Loading products…
    </div>

    <!-- NO RESULTS -->
    <div *ngIf="!loading && filtered.length === 0" class="text-center py-10 text-gray-500">
      No products found.
    </div>

    <!-- PRODUCT GRID -->
    <div
      *ngIf="!loading && paginated.length > 0"
      class="grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4"
    >
      <article
        *ngFor="let p of paginated; trackBy: trackById"
        class="border rounded-2xl shadow-sm hover:shadow-md transition bg-white overflow-hidden"
      >
        <a (click)="gotoDetail(p)" class="block cursor-pointer">
          <img
            [src]="p.image"
            [alt]="p.name"
            class="w-full h-48 object-cover rounded-t-2xl"
            (error)="onImgError($event)"
          />
        </a>

        <div class="p-4 text-left">
          <h3 class="font-semibold text-gray-800 truncate">{{ p.name }}</h3>
          <p class="text-sm text-gray-500 mb-2">{{ p.brand }}</p>
          <p class="font-bold text-sky-600 mb-3">${{ p.price }}</p>

          <button
            class="w-full bg-sky-500 text-white py-2 rounded-lg hover:bg-sky-600"
            (click)="gotoDetail(p)"
          >
            View Details
          </button>
        </div>
      </article>
    </div>

    <!-- PAGINATION -->
    <div class="flex justify-center gap-4 mt-10">
      <button
        (click)="prevPage()"
        [disabled]="currentPage === 1"
        class="px-4 py-2 border rounded disabled:opacity-50"
      >
        Prev
      </button>

      <button
        (click)="nextPage()"
        [disabled]="currentPage * pageSize >= filtered.length"
        class="px-4 py-2 border rounded disabled:opacity-50"
      >
        Next
      </button>
    </div>

  </div>
</div>
